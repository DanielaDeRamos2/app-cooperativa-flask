{% extends 'base.html' %}

{% block title %}Produtos - CoopVale - Cooperativa Rural Sustentável{% endblock %}

{% block extra_css %}
<style>
    .products-header {
        background: linear-gradient(135deg, var(--primary-green) 0%, var(--secondary-green) 100%);
        color: white;
        padding: 60px 20px;
        text-align: center;
        margin-bottom: 40px;
    }

    .products-header h1 {
        color: white;
        margin-bottom: 12px;
    }

    .products-header p {
        color: rgba(255, 255, 255, 0.9);
        font-size: 1.1rem;
    }

    .products-section {
        padding: 0 20px 60px;
    }

    .filters-bar {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        padding: 24px;
        margin-bottom: 40px;
        box-shadow: var(--shadow-sm);
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        align-items: center;
    }

    .filter-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
        flex: 1;
        min-width: 180px;
    }

    .filter-group label {
        color: var(--primary-green);
        font-weight: 700;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin: 0;
    }

    .filter-group input,
    .filter-group select {
        padding: 10px 14px;
        border: 2px solid var(--border);
        border-radius: 8px;
        font-size: 0.95rem;
        transition: var(--transition);
    }

    .filter-group input:focus,
    .filter-group select:focus {
        outline: none;
        border-color: var(--primary-green);
        box-shadow: 0 0 0 4px rgba(45, 90, 61, 0.1);
    }

    .filter-actions {
        display: flex;
        gap: 10px;
        margin-top: auto;
    }

    .filter-actions button {
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        font-weight: 700;
        cursor: pointer;
        transition: var(--transition);
        font-size: 0.9rem;
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .filter-actions button:first-child {
        background: linear-gradient(135deg, var(--primary-green), var(--secondary-green));
        color: white;
    }

    .filter-actions button:first-child:hover {
        box-shadow: var(--shadow-md);
        transform: translateY(-2px);
    }

    .filter-actions button:last-child {
        background: var(--light);
        color: var(--text);
        border: 1px solid var(--border);
    }

    .filter-actions button:last-child:hover {
        background: var(--border);
    }

    .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
        gap: 24px;
        margin-bottom: 40px;
    }

    .product-item {
        background: var(--surface);
        border-radius: var(--radius-lg);
        overflow: hidden;
        box-shadow: var(--shadow-md);
        transition: var(--transition);
        border: 1px solid var(--border);
        display: flex;
        flex-direction: column;
    }

    .product-item:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-lg);
        border-color: var(--primary-green);
    }

    .product-image {
        width: 100%;
        height: 180px;
        background: linear-gradient(135deg, rgba(45, 90, 61, 0.1), rgba(139, 111, 71, 0.1));
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3rem;
        color: var(--primary-green);
        overflow: hidden;
        position: relative;
    }

    .product-image::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
        transition: var(--transition);
    }

    .product-item:hover .product-image::before {
        left: 100%;
    }

    .product-info {
        padding: 20px;
        display: flex;
        flex-direction: column;
        flex: 1;
        gap: 12px;
    }

    .product-name {
        font-weight: 700;
        font-size: 1.05rem;
        color: var(--dark);
        margin: 0;
    }

    .product-producer {
        font-size: 0.85rem;
        color: var(--text-light);
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .product-description {
        font-size: 0.9rem;
        color: var(--text-light);
        margin: 0;
        flex: 1;
    }

    .product-price {
        font-weight: 900;
        font-size: 1.3rem;
        color: var(--primary-green);
        margin: 8px 0;
    }

    .product-badge {
        display: inline-block;
        background: linear-gradient(135deg, var(--accent-gold), var(--accent-yellow));
        color: var(--primary-green);
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
        width: fit-content;
        margin-bottom: 8px;
    }

    .product-actions {
        display: flex;
        gap: 10px;
        margin-top: auto;
    }

    .product-actions a {
        flex: 1;
        padding: 10px;
        border-radius: 8px;
        text-align: center;
        text-decoration: none;
        font-weight: 700;
        font-size: 0.9rem;
        transition: var(--transition);
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
    }

    .product-actions a:first-child {
        background: linear-gradient(135deg, var(--primary-green), var(--secondary-green));
        color: white;
    }

    .product-actions a:first-child:hover {
        background: linear-gradient(135deg, var(--secondary-green), var(--primary-green));
        transform: translateY(-2px);
    }

    .no-products {
        grid-column: 1 / -1;
        padding: 60px 20px;
        text-align: center;
        color: var(--text-light);
    }

    .no-products span {
        font-size: 3rem;
        display: block;
        margin-bottom: 16px;
        color: var(--primary-green);
        opacity: 0.6;
    }

    .pagination {
        display: flex;
        justify-content: center;
        gap: 8px;
        margin-top: 40px;
        padding: 20px;
    }

    .pagination a,
    .pagination span {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        transition: var(--transition);
        border: 1px solid var(--border);
    }

    .pagination a {
        color: var(--primary-green);
        background: var(--surface);
    }

    .pagination a:hover {
        background: var(--primary-green);
        color: white;
    }

    .pagination span.current {
        background: linear-gradient(135deg, var(--primary-green), var(--secondary-green));
        color: white;
        border: none;
    }

    @media (max-width: 768px) {
        .filters-bar {
            flex-direction: column;
        }

        .filter-group {
            min-width: 100%;
        }

        .filter-actions {
            width: 100%;
        }

        .filter-actions button {
            flex: 1;
            justify-content: center;
        }

        .products-grid {
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 16px;
        }
    }
</style>
{% endblock %}

{% block content %}
    <!-- Header -->
    <div class="products-header">
        <h1>{{ titulo }}</h1>
        <p>Explore nossa seleção de produtos frescos e sustentáveis</p>
    </div>

    <div class="container">
        <!-- Filtros -->
        <div class="filters-bar">
            <form method="get" style="display: flex; width: 100%; flex-wrap: wrap; gap: 20px; align-items: flex-end;">
                <div class="filter-group">
                    <label for="search">Buscar</label>
                    <input type="text" id="search" name="q" placeholder="Nome do produto..." value="{{ request.args.get('q', '') }}">
                </div>

                <div class="filter-group">
                    <label for="category">Categoria</label>
                    <select id="category" name="categoria">
                        <option value="">Todas as categorias</option>
                        <option value="hortifruti" {% if request.args.get('categoria') == 'hortifruti' %}selected{% endif %}>Hortifrúti</option>
                        <option value="laticinios" {% if request.args.get('categoria') == 'laticinios' %}selected{% endif %}>Laticínios</option>
                        <option value="acougue" {% if request.args.get('categoria') == 'acougue' %}selected{% endif %}>Açougue</option>
                        <option value="panificacao" {% if request.args.get('categoria') == 'panificacao' %}selected{% endif %}>Panificação</option>
                        <option value="artesanal" {% if request.args.get('categoria') == 'artesanal' %}selected{% endif %}>Artesanal</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="sort">Ordenar por</label>
                    <select id="sort" name="sort">
                        <option value="relevancia">Relevância</option>
                        <option value="preco_asc">Menor preço</option>
                        <option value="preco_desc">Maior preço</option>
                        <option value="nome">Nome (A-Z)</option>
                    </select>
                </div>

                <div class="filter-actions">
                    <button type="submit">
                        <span class="material-symbols-outlined">search</span>
                        Filtrar
                    </button>
                    <button type="reset">
                        <span class="material-symbols-outlined">refresh</span>
                        Limpar
                    </button>
                </div>
            </form>
        </div>

        <!-- Grid de Produtos -->
        <div class="products-section">
            {% if produtos %}
                <div class="products-grid">
                    {% for produto in produtos %}
                        <div class="product-item">
                            <div class="product-image">
                                <span class="material-symbols-outlined">shopping_bag</span>
                            </div>
                            <div class="product-info">
                                {% if loop.index <= 3 %}
                                    <div class="product-badge">Destaque</div>
                                {% endif %}
                                <h3 class="product-name">{{ produto.nome }}</h3>
                                <div class="product-producer">Produtor Local</div>
                                <p class="product-description">Produto de alta qualidade, cultivado com cuidado</p>
                                <div class="product-price">R$ {{ "%.2f"|format(produto.preco) }}</div>
                                <div class="product-actions">
                                    <a href="/produtos/{{ produto.id }}">
                                        <span class="material-symbols-outlined">info</span>
                                        Detalhes
                                    </a>
                                    <a href="/carrinho/" style="background: linear-gradient(135deg, var(--accent-gold), var(--accent-yellow)); color: var(--primary-green);">
                                        <span class="material-symbols-outlined">add_shopping_cart</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="no-products">
                    <span class="material-symbols-outlined">shopping_bag</span>
                    <h3>Nenhum produto encontrado</h3>
                    <p>Tente ajustar seus filtros ou navegue por nossas categorias</p>
                    <a href="/produtos" class="btn-primary" style="margin-top: 20px;">Ver Todos</a>
                </div>
            {% endif %}
        </div>

        <!-- Paginação (se necessário) -->
        <div class="pagination">
            <a href="#" title="Anterior">←</a>
            <span class="current">1</span>
            <a href="#">2</a>
            <a href="#">3</a>
            <a href="#" title="Próximo">→</a>
        </div>
    </div>
{% endblock %}
